(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const e={onDemand:1e4,baseline:1e4,peak:1e5,peakWidth:1,totalHoursPerMonth:730,pricePerRRU:125e-9,pricePerWRU:625e-9,pricePerRRU_IA:155e-9,pricePerWRU_IA:78e-8,pricePerRCU:65e-5,pricePerWCU:13e-5,pricePerRCU_IA:16e-5,pricePerWCU_IA:81e-5,pricePerRWRU:625e-9,pricePerRWRU_IA:78e-8,priceIntraRegPerGB:.02};function p(t){return t>=1e9?(t/1e9).toFixed(0)+"B":t>=1e6?(t/1e6).toFixed(0)+"M":t>=1e3?(t/1e3).toFixed(0)+"K":t>=1?t.toFixed(0):t.toString()}function E(){return{workload:new URLSearchParams(window.location.search).get("workload")||"morningPeak"}}const D=E();function S(t){const n=document.getElementById("costSavedTip");n.style.display="block",n.innerHTML=t.map(a=>{const[s,o]=a.split(": ");return`<div class="cost-entry"><span class="cost-key">${s}:</span><span class="cost-value">${o}</span></div>`}).join("")}const y=[{family:"i4i",instance:"i4i.xlarge",baseline:78e3,peak:12e4,storage:937,price:3.325},{family:"i3en",instance:"i3en.xlarge",baseline:39e3,peak:6e4,storage:2.44*1024,price:4.378}];function k(t,n,a,s){for(let o=3;o<1e3;o+=3){const i=3/o*t/n<=.9,r=s/3*o>=a;if(i&&r)return o}return 3}function w(){const t=e.storageGB*.5,n=.2,a=k(t,y[0].storage,e.totalOpsSec,y[0].baseline),s=k(t,y[1].storage,e.totalOpsSec,y[1].baseline),o=y[0].price,i=y[1].price,r=a/3*o*730*(1-n),l=s/3*i*730*(1-n),c=l<=r?l:r,v=l<=r?"i3en":"i4i",U=l<=r?s:a;return{scyllaCost:c,nodeCount:U,family:v}}function M(){e.tableClass=document.getElementById("tableClass").value}function $(){e.replicatedRegions=parseInt(document.getElementById("replicatedRegions").value)}function L(){e.storageGB=parseInt(document.getElementById("storage").value),e.itemSizeKB=parseInt(document.getElementById("itemSize").value)*(1/1024),e.itemSizeKB=e.itemSizeKB>1?Math.floor(e.itemSizeKB):e.itemSizeKB}function H(){e.readStronglyConsistent=parseInt(document.getElementById("readConst").value)/100,e.readEventuallyConsistent=1-e.readStronglyConsistent,e.readTransactional=parseInt(document.getElementById("readTrans").value)/100,e.readNonTransactional=1-e.readTransactional,e.writeTransactional=parseInt(document.getElementById("writeTrans").value)/100,e.writeNonTransactional=1-e.writeTransactional}function q(){e.readRatioDemand=parseInt(document.getElementById("ratioDemand").value)/100,e.writeRatioDemand=1-e.readRatioDemand}function F(){e.peakHours=e.peakWidth*30,e.baselineHours=e.totalHoursPerMonth-e.peakHours,e.reservedCapacity=parseInt(document.getElementById("reservedCapacity").value)/100,e.readRatioProvisioned=parseInt(document.getElementById("ratioProvisioned").value)/100,e.writeRatioProvisioned=1-e.readRatioProvisioned}function N(){e.writeRequestUnitsPerItem=Math.ceil(e.itemSizeKB),e.readRequestUnitsPerItem=Math.ceil(e.itemSizeKB/4),e.baselineWCUNonTransactional=e.baseline*e.writeRatioProvisioned*e.writeNonTransactional*e.writeRequestUnitsPerItem,e.baselineWCUTransactional=e.baseline*e.writeRatioProvisioned*e.writeTransactional*2*e.writeRequestUnitsPerItem,e.baselineWCUTotal=e.baselineWCUNonTransactional+e.baselineWCUTransactional,e.reservedWCU=e.baselineWCUTotal*e.reservedCapacity,e.reservedWCU=Math.ceil(e.reservedWCU/100)*100,e.provisionedBaselineWCU=e.baselineWCUTotal-e.reservedWCU,e.provisionedBaselineWCU=Math.ceil(Math.max(e.provisionedBaselineWCU,0)),e.provisionedBaselineWCUHours=Math.ceil(e.provisionedBaselineWCU*e.baselineHours),e.peakWCUNonTransactional=e.peak*e.writeRatioProvisioned*e.writeNonTransactional*e.writeRequestUnitsPerItem,e.peakWCUTransactional=e.peak*e.writeRatioProvisioned*e.writeTransactional*2*e.writeRequestUnitsPerItem,e.peakWCUTotal=e.peakWCUNonTransactional+e.peakWCUTransactional,e.provisionedPeakWCU=e.peakWCUTotal-e.reservedWCU,e.provisionedPeakWCU=Math.ceil(Math.max(e.provisionedPeakWCU,0)),e.provisionedPeakWCUHours=Math.ceil(e.provisionedPeakWCU*e.peakHours),e.provisionedTotalWCUHours=Math.ceil(e.provisionedBaselineWCUHours+e.provisionedPeakWCUHours),e.dynamoCostProvisionedWCU=e.provisionedTotalWCUHours*(e.tableClass==="standard"?e.pricePerWCU:e.pricePerWCU_IA),e.dynamoCostReplication=e.replicatedRegions*e.provisionedTotalWCUHours*(e.tableClass==="standard"?e.pricePerRWRU:e.pricePerRWRU_IA),e.dynamoCostReservedWCU=e.reservedWCU*128e-6*730,e.dynamoCostMonthlyWCU=e.dynamoCostProvisionedWCU+e.dynamoCostReservedWCU+e.dynamoCostReplication,e.dynamoCostUpfrontWCU=e.reservedWCU*1.5,e.baselineRCUNonTransactional=e.baseline*e.readRatioProvisioned*e.readEventuallyConsistent*.5*e.readRequestUnitsPerItem,e.baselineRCUStronglyConsistent=e.baseline*e.readRatioProvisioned*e.readStronglyConsistent*e.readRequestUnitsPerItem,e.baselineRCUTransactional=e.baseline*e.readRatioProvisioned*e.readTransactional*2*e.readRequestUnitsPerItem,e.baselineRCUTotal=e.baselineRCUNonTransactional+e.baselineRCUStronglyConsistent+e.baselineRCUTransactional,e.reservedRCU=e.baselineRCUTotal*e.reservedCapacity,e.reservedRCU=Math.ceil(e.reservedRCU/100)*100,e.provisionedBaselineRCU=e.baselineRCUTotal-e.reservedRCU,e.provisionedBaselineRCU=Math.ceil(Math.max(e.provisionedBaselineRCU,0)),e.provisionedBaselineRCUHours=Math.ceil(e.provisionedBaselineRCU*e.baselineHours),e.peakRCUNonTransactional=e.peak*e.readRatioProvisioned*e.readEventuallyConsistent*.5*e.readRequestUnitsPerItem,e.peakRCUStronglyConsistent=e.peak*e.readRatioProvisioned*e.readStronglyConsistent*e.readRequestUnitsPerItem,e.peakRCUTransactional=e.peak*e.readRatioProvisioned*e.readTransactional*2*e.readRequestUnitsPerItem,e.peakRCUTotal=e.peakRCUNonTransactional+e.peakRCUStronglyConsistent+e.peakRCUTransactional,e.provisionedPeakRCU=e.peakRCUTotal-e.reservedRCU,e.provisionedPeakRCU=Math.ceil(Math.max(e.provisionedPeakRCU,0)),e.provisionedPeakRCUHours=Math.ceil(e.provisionedPeakRCU*e.peakHours),e.provisionedTotalRCUHours=Math.ceil(e.provisionedBaselineRCUHours+e.provisionedPeakRCUHours),e.dynamoCostProvisionedRCU=e.provisionedTotalRCUHours*(e.tableClass==="standard"?e.pricePerRCU:e.pricePerRCU_IA),e.dynamoCostReservedRCU=e.reservedRCU*25e-6*730,e.dynamoCostMonthlyRCU=e.dynamoCostProvisionedRCU+e.dynamoCostReservedRCU,e.dynamoCostUpfrontRCU=e.reservedRCU*.3,e.dynamoCostProvisionedMonthly=e.dynamoCostMonthlyWCU+e.dynamoCostMonthlyRCU,e.dynamoCostProvisionedUpfront=e.dynamoCostUpfrontWCU+e.dynamoCostUpfrontRCU,e.dynamoCostProvisioned=e.dynamoCostProvisionedMonthly+e.dynamoCostProvisionedUpfront/12}function O(){e.readRequestUnitsPerItem=Math.ceil(e.itemSizeKB/4),e.writeRequestUnitsPerItem=Math.ceil(e.itemSizeKB),e.numberReads=e.onDemand*e.readRatioDemand*3600*e.totalHoursPerMonth,e.readRequestUnits=e.numberReads*e.readEventuallyConsistent*.5*e.readRequestUnitsPerItem+e.numberReads*e.readStronglyConsistent*e.readRequestUnitsPerItem+e.numberReads*e.readTransactional*2*e.readRequestUnitsPerItem,e.dynamoCostDemandReads=e.readRequestUnits*(e.tableClass==="standard"?e.pricePerRRU:e.pricePerRRU_IA),e.numberWrites=e.onDemand*e.writeRatioDemand*3600*e.totalHoursPerMonth,e.writeRequestUnits=e.numberWrites*e.writeNonTransactional*e.writeRequestUnitsPerItem+e.numberWrites*e.writeTransactional*2*e.writeRequestUnitsPerItem,e.dynamoCostDemandWrites=e.writeRequestUnits*(e.tableClass==="standard"?e.pricePerWRU:e.pricePerWRU_IA),e.dynamoCostReplication=e.replicatedRegions*e.writeRequestUnits*(e.tableClass==="standard"?e.pricePerRWRU:e.pricePerRWRU_IA),e.dynamoCostDemand=e.dynamoCostDemandReads+e.dynamoCostDemandWrites+e.dynamoCostReplication}function K(){e.totalReadsKB=e.readsOpsSec*3600*e.totalHoursPerMonth*e.itemSizeKB,e.totalWritesKB=e.writesOpsSec*3600*e.totalHoursPerMonth*e.itemSizeKB,e.totalReplicatedWritesGB=e.replicatedRegions*e.totalWritesKB/1024/1024,e.dynamoCostNetwork=e.totalReplicatedWritesGB*e.priceIntraRegPerGB}function f(){A(),M(),$(),L(),H(),q(),F(),N(),O(),z(),_(),K(),e.dynamoCostTotal=e.selectedPricingModel==="onDemand"?e.dynamoCostDemand+e.dynamoCostStorage:e.dynamoCostProvisioned+e.dynamoCostStorage,e.dynamoCostTotal=e.dynamoCostTotal+e.dynamoCostNetwork+e.dynamoCostReplication;const t=w(),n=e.dynamoCostTotal/2,a=(e.dynamoCostTotal/t.scyllaCost).toFixed(1);document.getElementById("costDiff").textContent=`$${p(n)}`,G(t,a),d.update()}function z(){e.dynamoCostStorage=e.storageGB*.25}function _(){e.readsOpsSec=e.selectedPricingModel==="onDemand"?e.onDemand*e.readRatioDemand:e.baseline*e.readRatioProvisioned,e.writesOpsSec=e.selectedPricingModel==="onDemand"?e.onDemand*e.writeRatioDemand:e.baseline*e.writeRatioProvisioned,e.totalOpsSec=e.readsOpsSec+e.writesOpsSec}function A(){e.selectedPricingModel=document.querySelector('input[name="pricingModel"]:checked').value}function G(t,n){let a=[`itemSizeKB: ${e.itemSizeKB} KB`,`storageGB: ${e.storageGB} GB`,`totalOpsSec: ${e.totalOpsSec.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}`];e.selectedPricingModel==="onDemand"?a=a.concat([`dynamoCostDemandReads: $${e.dynamoCostDemandReads.toFixed(2)}`,`dynamoCostDemandWrites: $${e.dynamoCostDemandWrites.toFixed(2)}`,`dynamoCostDemand: $${e.dynamoCostDemand.toFixed(2)}`]):a=a.concat([`dynamoCostMonthlyWCU: $${e.dynamoCostMonthlyWCU.toFixed(2)}`,`dynamoCostUpfrontWCU: $${e.dynamoCostUpfrontWCU.toFixed(2)}`,`dynamoCostMonthlyRCU: $${e.dynamoCostMonthlyRCU.toFixed(2)}`,`dynamoCostUpfrontRCU: $${e.dynamoCostUpfrontRCU.toFixed(2)}`]),a=a.concat([`dynamoCostNetwork: $${e.dynamoCostNetwork.toFixed(2)}`,`dynamoCostReplication: $${e.dynamoCostReplication.toFixed(2)}`,`dynamoCostStorage: $${e.dynamoCostStorage.toFixed(2)}`,`dynamoCostTotal: $${e.dynamoCostTotal.toFixed(2)}`,`scyllaCost: $${t.scyllaCost.toFixed(2)}`,`costRatio: ${n}`,`nodeCount: ${t.nodeCount}`,`family: ${t.family}`]),console.log(e),S(a)}function R(){const t=d.data.datasets[0].data,n=d.data.datasets[1].hidden?2:1,a=d.data.datasets[n].data;let s=0,o=0;for(let c=1;c<t.length;c++){const v=t[c-1].x,U=t[c-1].y,P=t[c].x,I=t[c].y,x=(U+I)/2*(P-v)*3600;s+=x}for(let c=1;c<a.length;c++){const v=a[c-1].x,U=a[c-1].y,P=a[c].x,I=a[c].y,x=(U+I)/2*(P-v)*3600;o+=x}const i=s/1e6,r=o/s*100,l=r<100?"red":"black";d.options.plugins.title.text=`Total Workload: ${i.toFixed(0)}M ops, Pricing coverage: ${r.toFixed(2)}%`,d.options.plugins.title.color=l,d.update()}const V=document.getElementById("chart").getContext("2d");function b(t,n,a){const s=[],o=Math.floor((24-a)/2),i=o+a;for(let r=0;r<=24;r++)r>=o&&r<i?s.push({x:r,y:n}):s.push({x:r,y:t});return s}function j(){return Array.from({length:25},(t,n)=>({x:n,y:e.onDemand}))}function Q(t){switch(t){case"twiceDaily":return[{x:0,y:5e3},{x:6,y:1e4},{x:8,y:1e5},{x:10,y:1e4},{x:12,y:5e3},{x:16,y:1e4},{x:18,y:1e5},{x:20,y:1e4},{x:24,y:5e3}];case"constant":return Array.from({length:25},(n,a)=>({x:a,y:5e4}));case"morningPeak":default:return[{x:0,y:5e3},{x:8,y:1e4},{x:9,y:1e5},{x:10,y:1e4},{x:24,y:5e3}]}}let X=j(),Y=b(e.baseline,e.peak,e.peakWidth),J=Q(D.workload);const d=new Chart(V,{type:"scatter",data:{datasets:[{label:"Workload",borderColor:"#0F1040",backgroundColor:"rgba(170,170,170,0.5)",data:J,fill:!0,showLine:!0,borderDash:[4,4],tension:.3},{label:"On Demand",data:X,borderColor:"#0F1040",backgroundColor:"rgba(15,16,64,0.8)",showLine:!0,pointRadius:0,fill:!0,tension:.1},{label:"Provisioned",data:Y,borderColor:"#0F1040",backgroundColor:"rgba(15,16,64,0.8)",fill:!0,tension:.1,showLine:!0,pointRadius:0,hidden:!0}]},options:{plugins:{legend:{display:!1},title:{display:!0,text:"Total Ops"},tooltip:{callbacks:{label:function(t){return"Workload: "+p(t.raw.y)+" ops/sec"}}},dragData:{round:1,showTooltip:!0,onDrag:function(t,n,a,s){s.x=Math.round(s.x),s.y=Math.round(s.y/1e3)*1e3},onDragEnd:function(t,n,a,s){R(),d.update()},dragX:!0,dragY:!0}},scales:{x:{min:0,max:24,title:{display:!1},ticks:{stepSize:1,callback:function(t){return t.toString().padStart(2,"0")+":00"}}},y:{type:"logarithmic",title:{display:!0,text:"op/sec"},min:1e3,max:1e7,ticks:{callback:function(t){return t===1e3?"1K":t===1e4?"10K":t===1e5?"100K":t===1e6?"1M":t===1e7?"10M":null}}}}}});function u(){d.data.datasets[1].data=Array.from({length:25},(t,n)=>({x:n,y:e.onDemand})),d.data.datasets[2].data=b(e.baseline,e.peak,e.peakWidth),d.update(),R(),f()}function m(t,n,a,s){const o=document.getElementById(t),i=document.getElementById(n),r=document.getElementById(a);o.addEventListener("click",function(l){l.stopPropagation(),i.value=parseInt(r.value),o.style.display="none",i.style.display="inline",setTimeout(()=>i.focus(),0)}),i.addEventListener("blur",function(){const l=parseInt(i.value);!isNaN(l)&&l>=r.min&&l<=r.max&&(r.value=l,o.innerText=s(l),u()),i.style.display="none",o.style.display="inline"}),i.addEventListener("keydown",function(l){(l.key==="Enter"||l.key==="Tab"||l.key==="Escape")&&(l.preventDefault(),i.blur())}),r.addEventListener("input",function(l){o.innerText=s(parseInt(l.target.value)),u()})}function T(t){const n=Chart.helpers.getRelativePosition(t,d),a=d.scales.x.getValueForPixel(n.x),s=d.scales.y.getValueForPixel(n.y);a>d.scales.x.min&&a<d.scales.x.max&&s>d.scales.y.min&&s<d.scales.y.max&&(d.data.datasets[0].data.push({x:a,y:s}),R(),d.update())}function B(t,n,a,s){document.getElementById(t).addEventListener("click",function(o){o.preventDefault();const i=document.getElementById(n);i.style.display==="none"?(i.style.display="block",this.textContent=a):(i.style.display="none",this.textContent=s)})}m("demandDsp","demandInp","demand",p);m("baselineDsp","baselineInp","baseline",p);m("peakDsp","peakInp","peak",p);m("peakWidthDsp","peakWidthInp","peakWidth",t=>t);m("itemSizeDsp","itemSizeInp","itemSize",t=>t<1024?`${t} B`:`${Math.floor(t/1024)} KB`);m("storageDsp","storageInp","storage",t=>t>=1024?(t/1024).toFixed(2)+" TB":t+" GB");m("replicatedRegionsDsp","replicatedRegionsInp","replicatedRegions",t=>t);document.getElementById("chart").onclick=function(t){T(t)};document.getElementById("chart").onclick=function(t){T(t)};document.querySelector('input[name="pricingModel"][value="onDemand"]').addEventListener("change",t=>{const n=document.getElementById("demandParams"),a=document.getElementById("provisionedParams");t.target.checked&&(n.style.display="block",a.style.display="none",d.data.datasets[1].hidden=!1,d.data.datasets[2].hidden=!0,d.update(),R(),f())});document.querySelector('input[name="pricingModel"][value="provisioned"]').addEventListener("change",t=>{const n=document.getElementById("demandParams"),a=document.getElementById("provisionedParams");t.target.checked&&(n.style.display="none",a.style.display="block",d.data.datasets[1].hidden=!0,d.data.datasets[2].hidden=!1,d.update(),R(),f())});document.getElementById("tableClass").addEventListener("change",t=>{e.tableClass=t.target.value,u()});document.getElementById("demand").addEventListener("input",t=>{e.onDemand=parseInt(t.target.value),document.getElementById("demandDsp").innerText=p(e.onDemand),u()});document.getElementById("ratioDemand").addEventListener("input",t=>{const n=parseInt(t.target.value),a=100-n;document.getElementById("ratioDemandDsp").innerText=`${n}/${a}`,u()});document.getElementById("baseline").addEventListener("input",t=>{e.baseline=parseInt(t.target.value),document.getElementById("baselineDsp").innerText=p(e.baseline),u()});document.getElementById("peakWidth").addEventListener("input",t=>{e.peakWidth=Math.max(1,parseInt(t.target.value)),document.getElementById("peakWidthDsp").innerText=e.peakWidth,u()});document.getElementById("peak").addEventListener("input",t=>{e.peak=parseInt(t.target.value),document.getElementById("peakDsp").innerText=p(e.peak),u()});document.getElementById("ratioProvisioned").addEventListener("input",t=>{const n=parseInt(t.target.value),a=100-n;document.getElementById("ratioProvisionedDsp").innerText=`${n}/${a}`,u()});document.getElementById("reservedCapacity").addEventListener("input",t=>{e.reservedCapacity=parseInt(t.target.value),document.getElementById("reservedCapacityDsp").innerText=`${p(e.reservedCapacity)}%`,u()});document.getElementById("storage").addEventListener("input",t=>{const n=parseInt(t.target.value);document.getElementById("storageDsp").innerText=n>=1024?(n/1024).toFixed(2)+" TB":n+" GB",u()});document.getElementById("storageDsp").innerText=document.getElementById("storage").value;B("tableLink","tableParams","▲ Tables","▼ Tables");B("storageLink","storageParams","▲ Storage","▼ Storage");B("consistencyLink","consistencyParams","▲ Consistency","▼ Consistency");document.getElementById("itemSize").addEventListener("input",function(t){const n=t.target,a=parseInt(n.value);a<=1024?n.step=64:n.step=1024;let s;a<1024?s=`${a} B`:s=`${Math.floor(a/1024)} KB`,document.getElementById("itemSizeDsp").innerText=s,u()});document.getElementById("writeTrans").addEventListener("input",t=>{const n=parseInt(t.target.value);document.getElementById("writeConsistencyDsp").innerText=n===0?"Non Transactional":n===100?"Transactional":`${n}% Transactional (${100-n}% Non Transactional)`,u()});const C=document.getElementById("readConst"),g=document.getElementById("readTrans"),h=document.getElementById("readConstDsp");function W(){const t=parseInt(C.value);let n=parseInt(g.value),a=100-t-n;t===100?h.innerText="Strongly Consistent":a===100?h.innerText="Eventually Consistent":h.innerText=`Strongly Consistent: ${t}%, Eventually Consistent: ${a}%, Transactional: ${n}%`,u()}C.addEventListener("input",()=>{parseInt(C.value)>100-parseInt(g.value)&&(g.value=100-C.value),W()});g.addEventListener("input",()=>{100-parseInt(g.value)<parseInt(C.value)&&(C.value=100-g.value),W()});R();f();
